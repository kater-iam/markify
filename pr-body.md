# エラー処理とデバッグ機能の改善

## 概要
エラー処理とデバッグ機能を共通モジュールに移動し、コードの保守性と再利用性を向上させました。

## 変更内容
1. エラー処理の共通化
   - エラーハンドリング関数を `_shared/utils.ts` に移動
   - 型安全性の向上（`unknown` 型の適切な処理）
   - エラーレスポンスの標準化

2. デバッグ機能の共通化
   - デバッグユーティリティを `_shared/utils.ts` に移動
   - すべてのログ出力を共通モジュールの `debug` ユーティリティを使用するように変更
   - 環境変数 `DEBUG` による制御機能の統一

3. 設計ドキュメントの更新
   - エラー処理の実装詳細を追加
   - アーキテクチャの説明を更新

## 動作確認
- テストスクリプトによる動作確認を実施
- 画像の生成が正常に行われることを確認（ファイルサイズ: 91K）
- デバッグログの出力を確認 